{
    "version": "https://jsonfeed.org/version/1",
    "title": "Hacking to the gate! • All posts by \"dns\" tag",
    "description": "Bipedal Bit's blog",
    "home_page_url": "https://bipedalbit.net",
    "items": [
        {
            "id": "https://bipedalbit.net/2025/06/11/%E8%AE%B0%E4%B8%80%E6%AC%A1DNS%E6%B1%A1%E6%9F%93%E5%BA%94%E5%AF%B9/",
            "url": "https://bipedalbit.net/2025/06/11/%E8%AE%B0%E4%B8%80%E6%AC%A1DNS%E6%B1%A1%E6%9F%93%E5%BA%94%E5%AF%B9/",
            "title": "记一次DNS污染应对",
            "date_published": "2025-06-11T12:22:04.000Z",
            "content_html": "<p>静态站的waline评论插件服务的二级域名被ISP DNS做了污染封禁导致评论插件和访问计数不可用。记录一下我排查和解决问题的过程与思考。</p>\n<span id=\"more\"></span>\n<h1 id=\"现象\"><a href=\"#现象\" class=\"headerlink\" title=\"现象\"></a>现象</h1><ul>\n<li><p>特定条件下，从客户端访问我的静态站时，客户端请求我的自建waline服务失败，看响应头发现remote ip是(::1)，ipv6回环地址。</p>\n</li>\n<li><p>ping对应域名证实DNS结果确实为(::1)。</p>\n</li>\n<li><p>为了明确问题，我用不同网络环境做了测试：</p>\n</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th>网络</th>\n<th>代理</th>\n<th>DNS</th>\n<th>结果</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>中国移动蜂巢5G</td>\n<td>关闭</td>\n<td>自动</td>\n<td>fail</td>\n</tr>\n<tr>\n<td>中国移动蜂巢5G</td>\n<td>全局</td>\n<td>等同于8.8.8.8</td>\n<td>success</td>\n</tr>\n<tr>\n<td>中国移动蜂巢5G</td>\n<td>关闭</td>\n<td>114.114.114.114</td>\n<td>success</td>\n</tr>\n<tr>\n<td>中国移动光纤宽带</td>\n<td>关闭</td>\n<td>自动</td>\n<td>fail</td>\n</tr>\n<tr>\n<td>中国移动光纤宽带</td>\n<td>全局</td>\n<td>等同于8.8.8.8</td>\n<td>success</td>\n</tr>\n<tr>\n<td>中国移动光纤宽带</td>\n<td>关闭</td>\n<td>114.114.114.114</td>\n<td>success</td>\n</tr>\n</tbody></table>\n<p>我手头只有移动的5G网络和宽带网络，还不好排除ISP本身状态的影响，但绕过中国移动网络的ISP DNS，就能成功。</p>\n<p>初步判断是DNS的问题。上<a href=\"https://dnschecker.org/\">DNSChecker</a>验证一下非ISP DNS，用当前的中国移动ISP+各种全球非ISP DNS做测试，结果是域名解析全部正确。那么看起来真的很可能是ISP DNS主动做了污染。</p>\n<p>搜搜有前科吗？有的，国内ISP偶现用回环地址做DNS污染来针对性封禁域名的情况。</p>\n<p>捞个本地的移动ISP DNS试试，<code>dig @211.137.64.163 &lt;domain&gt;</code>：</p>\n<figure class=\"highlight nix\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs nix\">; <span class=\"hljs-operator\">&lt;</span><span class=\"hljs-operator\">&lt;</span><span class=\"hljs-operator\">&gt;</span><span class=\"hljs-operator\">&gt;</span> DiG <span class=\"hljs-number\">9.18</span>.<span class=\"hljs-number\">3</span>0-<span class=\"hljs-number\">0</span>ubuntu0.<span class=\"hljs-number\">24.04</span>.<span class=\"hljs-number\">2</span><span class=\"hljs-operator\">-</span>Ubuntu <span class=\"hljs-operator\">&lt;</span><span class=\"hljs-operator\">&lt;</span><span class=\"hljs-operator\">&gt;</span><span class=\"hljs-operator\">&gt;</span> @<span class=\"hljs-number\">211.137</span>.<span class=\"hljs-number\">64.163</span> <span class=\"hljs-symbol\">&lt;domain&gt;</span><br>; (<span class=\"hljs-number\">1</span> server found)<br>;; global <span class=\"hljs-params\">options:</span> <span class=\"hljs-operator\">+</span>cmd<br>;; Got <span class=\"hljs-params\">answer:</span><br>;; <span class=\"hljs-operator\">-&gt;</span><span class=\"hljs-operator\">&gt;</span>HEADER<span class=\"hljs-operator\">&lt;</span><span class=\"hljs-operator\">&lt;</span><span class=\"hljs-operator\">-</span> <span class=\"hljs-params\">opcode:</span> QUERY, <span class=\"hljs-params\">status:</span> NOERROR, <span class=\"hljs-params\">id:</span> <span class=\"hljs-number\">48130</span><br>;; <span class=\"hljs-params\">flags:</span> qr rd ra; <span class=\"hljs-params\">QUERY:</span> <span class=\"hljs-number\">1</span>, <span class=\"hljs-params\">ANSWER:</span> <span class=\"hljs-number\">1</span>, <span class=\"hljs-params\">AUTHORITY:</span> <span class=\"hljs-number\">0</span>, <span class=\"hljs-params\">ADDITIONAL:</span> <span class=\"hljs-number\">0</span><br><br>;; QUESTION <span class=\"hljs-params\">SECTION:</span><br>;<span class=\"hljs-symbol\">&lt;domain&gt;</span>.\t\tIN\tA<br><br>;; ANSWER <span class=\"hljs-params\">SECTION:</span><br><span class=\"hljs-symbol\">&lt;domain&gt;</span>.\t<span class=\"hljs-number\">3600</span>\tIN\tA\t<span class=\"hljs-number\">127.0</span>.<span class=\"hljs-number\">0.1</span><br><br>;; Query <span class=\"hljs-params\">time:</span> <span class=\"hljs-number\">5</span> msec<br>;; <span class=\"hljs-params\">SERVER:</span> <span class=\"hljs-number\">211.137</span>.<span class=\"hljs-number\">64.163</span><span class=\"hljs-comment\">#53(211.137.64.163) (UDP)</span><br>;; <span class=\"hljs-params\">WHEN:</span> Wed Jun <span class=\"hljs-number\">11</span> <span class=\"hljs-number\">20</span>:<span class=\"hljs-number\">16</span>:<span class=\"hljs-number\">16</span> CST <span class=\"hljs-number\">2025</span><br>;; MSG SIZE  <span class=\"hljs-params\">rcvd:</span> <span class=\"hljs-number\">55</span><br></code></pre></td></tr></table></figure>\n\n<p>真的给我解成了回环地址。</p>\n<p>上班时也试了下电信的ISP DNS，<code>dig @202.103.24.68 &lt;domain&gt;</code>：</p>\n<figure class=\"highlight nix\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs nix\">; <span class=\"hljs-operator\">&lt;</span><span class=\"hljs-operator\">&lt;</span><span class=\"hljs-operator\">&gt;</span><span class=\"hljs-operator\">&gt;</span> DiG <span class=\"hljs-number\">9.11</span>.<span class=\"hljs-number\">5</span><span class=\"hljs-operator\">-</span>P4-<span class=\"hljs-number\">5.1</span><span class=\"hljs-operator\">+</span>deb10u11-Debian <span class=\"hljs-operator\">&lt;</span><span class=\"hljs-operator\">&lt;</span><span class=\"hljs-operator\">&gt;</span><span class=\"hljs-operator\">&gt;</span> @<span class=\"hljs-number\">202.103</span>.<span class=\"hljs-number\">24.68</span> <span class=\"hljs-symbol\">&lt;domain&gt;</span><br>; (<span class=\"hljs-number\">1</span> server found)<br>;; global <span class=\"hljs-params\">options:</span> <span class=\"hljs-operator\">+</span>cmd<br>;; Got <span class=\"hljs-params\">answer:</span><br>;; <span class=\"hljs-operator\">-&gt;</span><span class=\"hljs-operator\">&gt;</span>HEADER<span class=\"hljs-operator\">&lt;</span><span class=\"hljs-operator\">&lt;</span><span class=\"hljs-operator\">-</span> <span class=\"hljs-params\">opcode:</span> QUERY, <span class=\"hljs-params\">status:</span> NOERROR, <span class=\"hljs-params\">id:</span> <span class=\"hljs-number\">17701</span><br>;; <span class=\"hljs-params\">flags:</span> qr aa rd; <span class=\"hljs-params\">QUERY:</span> <span class=\"hljs-number\">1</span>, <span class=\"hljs-params\">ANSWER:</span> <span class=\"hljs-number\">1</span>, <span class=\"hljs-params\">AUTHORITY:</span> <span class=\"hljs-number\">0</span>, <span class=\"hljs-params\">ADDITIONAL:</span> <span class=\"hljs-number\">0</span><br>;; <span class=\"hljs-params\">WARNING:</span> recursion requested but not available<br><br>;; QUESTION <span class=\"hljs-params\">SECTION:</span><br>;<span class=\"hljs-symbol\">&lt;domain&gt;</span>.\t\tIN\tA<br><br>;; ANSWER <span class=\"hljs-params\">SECTION:</span><br><span class=\"hljs-symbol\">&lt;domain&gt;</span>.\t<span class=\"hljs-number\">300</span>\tIN\tA\t<span class=\"hljs-number\">127.0</span>.<span class=\"hljs-number\">0.1</span><br><br>;; Query <span class=\"hljs-params\">time:</span> <span class=\"hljs-number\">5</span> msec<br>;; <span class=\"hljs-params\">SERVER:</span> <span class=\"hljs-number\">202.103</span>.<span class=\"hljs-number\">24.68</span><span class=\"hljs-comment\">#53(202.103.24.68)</span><br>;; <span class=\"hljs-params\">WHEN:</span> 三 <span class=\"hljs-number\">6</span>月 <span class=\"hljs-number\">11</span> <span class=\"hljs-number\">16</span>:<span class=\"hljs-number\">16</span>:<span class=\"hljs-number\">34</span> CST <span class=\"hljs-number\">2025</span><br>;; MSG SIZE  <span class=\"hljs-params\">rcvd:</span> <span class=\"hljs-number\">55</span><br></code></pre></td></tr></table></figure>\n\n<p>看来还不止被一个ISP做了DNS污染，都给我解成回环地址。</p>\n<h1 id=\"DNS劫持与DNS污染\"><a href=\"#DNS劫持与DNS污染\" class=\"headerlink\" title=\"DNS劫持与DNS污染\"></a>DNS劫持与DNS污染</h1><table>\n<thead>\n<tr>\n<th><strong>对比维度</strong></th>\n<th><strong>DNS劫持</strong></th>\n<th><strong>DNS污染</strong></th>\n</tr>\n</thead>\n<tbody><tr>\n<td><strong>攻击方式</strong></td>\n<td>篡改DNS解析结果</td>\n<td>伪造DNS响应数据</td>\n</tr>\n<tr>\n<td><strong>影响范围</strong></td>\n<td>个体或小范围</td>\n<td>大范围或区域</td>\n</tr>\n<tr>\n<td><strong>目的</strong></td>\n<td>诱导用户访问恶意网站</td>\n<td>干扰用户访问特定服务</td>\n</tr>\n<tr>\n<td><strong>典型场景</strong></td>\n<td>钓鱼、恶意软件传播</td>\n<td>网络封锁、广告注入</td>\n</tr>\n</tbody></table>\n<p>DNS劫持通常在客户端完成，DNS污染通常在网关或DNS服务上操作。</p>\n<h1 id=\"分析原因\"><a href=\"#分析原因\" class=\"headerlink\" title=\"分析原因\"></a>分析原因</h1><ul>\n<li>捞了下waline服务的日志，发现有不少”&#x2F;robots.txt not found”，还在80、443口都来了一遍。有搜索引擎爬虫或者模拟搜索引擎的爬虫试图抓取我waline服务端的响应内容，那么可能有人在收录或分析我的waline服务。其实应该也分析不出什么，这服务没过鉴权的情况下响应体里甚至不包含文字。</li>\n<li>其实也可能是二级域名本身的关键词命中了什么政策类的域名筛选规则，大家给二级域名起名也要谨慎点。</li>\n</ul>\n<h1 id=\"应对\"><a href=\"#应对\" class=\"headerlink\" title=\"应对\"></a>应对</h1><ul>\n<li><p>除了用于展示内容的静态站域名，其他功能性二级域名都用nginx配置加上禁爬声明先：</p>\n<figure class=\"highlight nginx\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs nginx\"><span class=\"hljs-comment\"># HTTP server block</span><br><span class=\"hljs-section\">server</span> &#123;<br>    <span class=\"hljs-attribute\">listen</span> <span class=\"hljs-number\">80</span>;<br>    <span class=\"hljs-attribute\">server_name</span> example.com;<br><br>    <span class=\"hljs-comment\"># 禁止爬虫访问所有内容</span><br>    <span class=\"hljs-section\">location</span> = /robots.txt &#123;<br>        <span class=\"hljs-attribute\">return</span> <span class=\"hljs-number\">200</span> <span class=\"hljs-string\">&quot;User-agent: *\\&quot;\\nDisallow: /&quot;</span>;<br>        <span class=\"hljs-attribute\">add_header</span> Content-Type text/plain;<br>        <span class=\"hljs-attribute\">add_header</span> Cache-Control <span class=\"hljs-string\">&quot;public, max-age=3600&quot;</span>;<br>        <span class=\"hljs-attribute\">if</span> (<span class=\"hljs-variable\">$request_method</span> !<span class=\"hljs-regexp\">~ ^(GET|HEAD)$</span> ) &#123;<br>            <span class=\"hljs-attribute\">return</span> <span class=\"hljs-number\">405</span>;<br>        &#125;<br>    &#125;<br><br>    <span class=\"hljs-comment\"># 其他请求重定向到 HTTPS</span><br>    <span class=\"hljs-section\">location</span> / &#123;<br>        <span class=\"hljs-attribute\">return</span> <span class=\"hljs-number\">301</span> https://<span class=\"hljs-variable\">$host</span><span class=\"hljs-variable\">$request_uri</span>;<br>    &#125;<br>&#125;<br><br><span class=\"hljs-comment\"># HTTPS server block</span><br><span class=\"hljs-section\">server</span> &#123;<br>    <span class=\"hljs-attribute\">listen</span> <span class=\"hljs-number\">443</span> ssl;<br>    <span class=\"hljs-attribute\">server_name</span> example.com;<br><br>    <span class=\"hljs-attribute\">ssl_certificate</span> /path/to/cert.pem;<br>    <span class=\"hljs-attribute\">ssl_certificate_key</span> /path/to/privkey.pem;<br><br>    <span class=\"hljs-comment\"># 禁止爬虫访问所有内容</span><br>    <span class=\"hljs-section\">location</span> = /robots.txt &#123;<br>        <span class=\"hljs-attribute\">return</span> <span class=\"hljs-number\">200</span> <span class=\"hljs-string\">&quot;User-agent: *\\&quot;\\nDisallow: /&quot;</span>;<br>        <span class=\"hljs-attribute\">add_header</span> Content-Type text/plain;<br>        <span class=\"hljs-attribute\">add_header</span> Cache-Control <span class=\"hljs-string\">&quot;public, max-age=3600&quot;</span>;<br>        <span class=\"hljs-attribute\">if</span> (<span class=\"hljs-variable\">$request_method</span> !<span class=\"hljs-regexp\">~ ^(GET|HEAD)$</span> ) &#123;<br>            <span class=\"hljs-attribute\">return</span> <span class=\"hljs-number\">405</span>;<br>        &#125;<br>    &#125;<br><br>    <span class=\"hljs-comment\"># 其他请求处理（如 root、proxy_pass 等）</span><br>    <span class=\"hljs-section\">location</span> / &#123;<br>        <span class=\"hljs-comment\"># 你的其他配置，如 proxy_pass 或 root</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>\n</li>\n<li><p>再给二级域名换成个更烂大街的抽象名称躲封禁规则，配好对应DNS记录和nginx路由。</p>\n</li>\n<li><p>用certbot更新下SSL证书：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\">certbot certonly ----cert-name &lt;cert_name&gt; --manual --preferred-challenges http --webroot-path /root/Dropbox/&lt;homepage_dir&gt; -m me@bipedalbit.net -d &lt;domain1&gt; -d &lt;domain2&gt; -d &lt;domain3&gt;<br></code></pre></td></tr></table></figure>\n</li>\n<li><p>我不爱用<code>certbot run</code>自动改nginx配置文件更新SSL证书，会把我写好的nginx配置格式搞乱。用<code>certbot certonly</code>命令需要按命令行提示在指定域名下指定位置放个指定内容的文本文件证明你是指定域名内容的控制方，然后回车下一步。麻烦点，但低频操作，不自动化也负担不大。</p>\n</li>\n<li><p>改改waline服务的部署配置，把里面的服务二级域名更新下，重启服务。</p>\n</li>\n<li><p>OK这下通了，观察一天看看，还是通的，大概是妥了。</p>\n</li>\n</ul>\n",
            "tags": [
                "DNS",
                "DNS劫持",
                "DNS污染"
            ]
        },
        {
            "id": "https://bipedalbit.net/2016/04/24/hexo%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/",
            "url": "https://bipedalbit.net/2016/04/24/hexo%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/",
            "title": "hexo博客搭建",
            "date_published": "2016-04-24T13:02:39.000Z",
            "content_html": "<p>&nbsp;&nbsp;&nbsp; 转眼三个多月没更博文了，并没有荒废只是有点忙。攒了很多想写的东西，先填个拖了很久的坑：我这个博客是怎么搭起来的。<br>&nbsp;&nbsp;&nbsp; 总的来说，我的博客是由Github Pages维护，本地用Hexo管理的一个静态博客。这篇文里我将介绍搭建Github Pages+Hexo博客的过程。</p>\n<span id=\"more\"></span>\n<p>&nbsp;&nbsp;&nbsp; 在讲搭建流程之前需要铺垫一下，介绍几个基本概念，Github Pages、Hexo、域名和DNS服务。</p>\n<h3 id=\"Github-Pages\"><a href=\"#Github-Pages\" class=\"headerlink\" title=\"Github Pages\"></a>Github Pages</h3><p>&nbsp;&nbsp;&nbsp; 如果想搭建一个自己的博客，首先你需要一个7×24不间断服务的稳定服务器。一般来说，geek们不会自己买一个，我们可以租一个云服务器。有更好的选择吗？有。我们也可以找到一些免费的云空间，比如新浪的SAE（以后没准就不免费了），还有我要讲的Github Pages。Github Pages是Github（如果你不知道Github是什么可以自己百度，这里我不太想解释）提供的一项福利，帮助广大geek们维护一个静态网站空间。静态网站就是页面内容不会随着数据库中数据的变化而动态的发生变化的网站，各大购物网站都是典型的动态网站。通常个人博客主要包含静态内容，就算需要修改更新，手动处理也完全足够，评论系统除外，但评论系统可以用第三方插件。于是这里有了分歧，一部分人选择了自己管理评论系统的数据库，还想偶尔在网站上玩点酷炫的动态网站花活，比如挂个网页游戏或者弹幕播放器，他们需要一个完全控制的云服务器，如SAE、百度云、腾讯云、Linode、Conoha等等；另一部分人希望让博客单纯一点，静态网站是更好的选择，Github向每一个用户帐号免费提供一个静态网站空间。<br>&nbsp;&nbsp;&nbsp; Github Page使用起来很简单，它的<a href=\"https://pages.github.com/\">网站首页</a>上有讲解，其实就是在Github新建一个repository，命名为username.github.io，其中username为你的Github用户名。这个repository就是你的静态网站空间了，访问它可以使用刚才的username.github.io，也就是Github Pages的二级域名。如果你是Github的用户，接下来你一定知道怎么更新网站内容了。</p>\n<h3 id=\"Hexo\"><a href=\"#Hexo\" class=\"headerlink\" title=\"Hexo\"></a>Hexo</h3><p>&nbsp;&nbsp;&nbsp; Hexo是一个开源的静态博客生成器，用node.js开发，作者是台湾大学生tommy351。这里我要提一句，node.js不是js，是基于谷歌v8引擎（js解析引擎）开发的一种服务端语言，语法与js没有什么两样，可以在http协议外（使用socket.io包）实现区别于AJAX的服务器主动推，鼓吹面向过程、基于消息机制的函数异步处理特性。Hexo封装了不止一种对免费服务器空间的接口，其中也包括Github的。这篇文里我准备介绍的是Github Pages搭配Hexo的搭建方式。</p>\n<h3 id=\"域名与DNS\"><a href=\"#域名与DNS\" class=\"headerlink\" title=\"域名与DNS\"></a>域名与DNS</h3><p>&nbsp;&nbsp;&nbsp; 要怎么访问一个网站？你当然可以直接访问网站的IP地址，但是这不方便，大家一般都使用域名（Domain）。域名最右边的一节是域名后缀，通常用于标识域名类型，域名最右边的两节xxx.xxx作为一个整体通常表示一个顶级域名。它的左边可以再加若干节，如果加了，那些就都是顶级域名下的子域名了。为了完成特定域名（包括子域名）到特定IP的映射，需要一个DNS（Domain Name System）服务器，它将对特定域名的请求转发到特定的IP地址。</p>\n<h3 id=\"Github-Pages-Hexo环境搭建\"><a href=\"#Github-Pages-Hexo环境搭建\" class=\"headerlink\" title=\"Github Pages+Hexo环境搭建\"></a>Github Pages+Hexo环境搭建</h3><p>&nbsp;&nbsp;&nbsp; Hexo有一些依赖环境，但是它没有现成的安装包，开源项目嘛，无可厚非。首先你需要安装node.js环境，大家系统平台多种多样，怎么装就自己去<a href=\"http://nodejs.cn/\">node官网</a>上看吧；git客户端也是要装的，同理也自己去<a href=\"https://git-scm.com/downloads\">官网</a>看。此外我们还需要分发个SSH证书，就是把你计算机的公钥在Github帐号里复制一份，这样通过SSH方式连接Github时就可以验证你的身份，就不用输用户名密码了。而Hexo连接Github的方式就是走的SSH方式，所以这个步骤是必要的。win平台通常用SSH Client管理SSH连接，或者也可以用终端形式的putty或者SSH Secure Shell；Ubuntu下是<code>sudo apt-get install openssh-server</code>；CentOS下是<code>sudo yum install openssh-server</code>；Mac OS自带SSH客户端。私钥公钥生成和端口配置什么的我不是很想全都介绍，说个Ubuntu的吧，比较简单。<br>&nbsp;&nbsp;&nbsp; 没配git帐号的先配一下：</p>\n<pre><code class=\"hljs\">git config --global user.email &quot;你的邮箱&quot;\ngit config --global user.name &quot;你的Github用户名&quot;\n</code></pre>\n<p>&nbsp;&nbsp;&nbsp; 生成SSH密钥对：</p>\n<pre><code class=\"hljs\">ssh -keygen -t rsa -C&quot;前面配git时填过的邮箱&quot;\n</code></pre>\n<p>&nbsp;&nbsp;&nbsp; 然后一路回车，然后你在<code>~/.ssh</code>目录下就有了id_rsa和id_rsa.pub两个文件，它们分别是你的私钥和公钥，你需要把私钥登记一下：</p>\n<pre><code class=\"hljs\">ssh-add id_rsa\n</code></pre>\n<p>&nbsp;&nbsp;&nbsp; 接下来就是分发公钥了，你可以手动进id_rsa.pub复制公钥内容，也可以用系统工具复制：</p>\n<pre><code class=\"hljs\">xclip -selection c  ~/.ssh/id_rsa.pub\n</code></pre>\n<p>&nbsp;&nbsp;&nbsp; 然后登录Github并<a href=\"https://github.com/settings/ssh\">Add SSH Key</a>，给新公钥起个名粘贴进去就好。然后测试一下：</p>\n<pre><code class=\"hljs\">ssh -T git@github.com\n</code></pre>\n<p>&nbsp;&nbsp;&nbsp; 提示信息包含“successfully authenticated”就算成功了。如果有问题，可以重新设置，常见问题请参考：<br><a href=\"https://help.github.com/articles/generating-an-ssh-key/\">GitHub Help - Generating SSH Keys</a><br><a href=\"https://help.github.com/articles/error-permission-denied-publickey/\">GitHub Help - Error Permission denied (publickey)</a><br>&nbsp;&nbsp;&nbsp; 接下来是为node安装Hexo包：</p>\n<pre><code class=\"hljs\">npm install -g hexo\n</code></pre>\n<p>&nbsp;&nbsp;&nbsp; Hexo封装了一些博客管理接口：<br>\t<br>\thexo init <folder>  # 初始化目录，可以指定目录地址，我更喜欢进入目录后hexo init一下<br>\thexo n “title” # 创建新文章，你会在&#x2F;source&#x2F;_post目录下找到包含title的新md文档，你可以编辑它<br>\thexo s # 在本地查起服务查看效果，默认是访问0.0.0.0:4000<br>\thexo g # 为博客重新生成静态页面<br>\thexo d # 同步到Github Pages空间</p>\n<h3 id=\"写博文\"><a href=\"#写博文\" class=\"headerlink\" title=\"写博文\"></a>写博文</h3><p>&nbsp;&nbsp;&nbsp; 前面提到过，<code>hexo n</code>之后我们就获得了一个新md文档，接下来你需要按照Markdown语法编辑这个文档。但Hexo的博文还需要包含一些必要内容以辅助页面关联及效果：</p>\n<pre><code class=\"hljs\">title: postName #文章页面上的显示名称，可以任意修改，不会出现在URL中\ndate: 2016-4-25 11:30:16 #文章生成时间，一般不改，当然也可以任意修改\ncategories: #文章分类目录，可以为空，注意:后面有个空格\ntags: #文章标签，可空，多标签请用格式[tag1,tag2,tag3]，注意:后面有个空格\nphotos: #fancybox功能将要显示是图片集合\n- http://bruce.u.qiniudn.com/2013/11/27/reading/photos-0.jpg\n- http://bruce.u.qiniudn.com/2013/11/27/reading/photos-1.jpg\n---\n摘要\n&lt;!--more--&gt;\n这里开始使用markdown格式输入你的正文。\n</code></pre>\n<p>&nbsp;&nbsp;&nbsp; 至于Markdown语法，读者可以自行百度，网上很多。写完保存之后可以先<code>hexo s</code>一下，去0.0.0.0:4000看效果，如果觉得满意，再<code>hexo g</code>生成静态页面并<code>hexo d</code>同步到Github Pages。注意这里生成的整个静态网站页面都在&#x2F;public子目录下，你完全可以起一个服务器把本地80口映射到这里。</p>\n<h3 id=\"主题安装\"><a href=\"#主题安装\" class=\"headerlink\" title=\"主题安装\"></a>主题安装</h3><p>&nbsp;&nbsp;&nbsp; Hexo迄今为止已经衍生出了很多主题，主题列表<a href=\"https://github.com/hexojs/hexo/wiki/Themes\">Hexo Themes</a>，我的博客使用的是<a href=\"https://github.com/xiangming/landscape-plus\">Landscape plus</a>，一个专为中国大陆用户做过调整的Hexo主题，别的Hexo主题读者可以自己百度一下。<code>hexo init</code>一个目录之后，把选定的主题<code>git clone</code>到Hexo目录的themes子目录下，然后编辑&#x2F;_config.yml：</p>\n<pre><code class=\"hljs\">theme: themename\n</code></pre>\n<p>&nbsp;&nbsp;&nbsp; 然后配置一下主题下的_config.yml：<br>\t<br>\tmenu: #配置页头显示哪些菜单<br>\t#  Home: &#x2F;<br>\t  Archives: &#x2F;archives<br>\t  Reading: &#x2F;reading<br>\t  About: &#x2F;about<br>\t#  Guestbook: &#x2F;about</p>\n<pre><code class=\"hljs\">excerpt_link: Read More #摘要链接文字\narchive_yearly: false #按年存档\n\nwidgets: #配置页脚显示哪些小挂件\n\t- category\n#  - tag\n\t- tagcloud\n\t- recent_posts\n#  - blogroll\n\nblogrolls: #友情链接\n\t- sitename: http://site.address\n\t- sitename: http://site.address\n\t- sitename: http://site.address\n\nfancybox: true #是否开启fancybox效果，就是文章开头加一个电子相册的感觉\n\nduoshuo_shortname: username #多说账号\n\ngoogle_analytics:\nrss:\n</code></pre>\n<p>&nbsp;&nbsp;&nbsp; 要更新主题只需要从Github拉取主题内容即可<code>cd themes/modernist</code>然后<code>git pull</code>。</p>\n<h3 id=\"评论插件\"><a href=\"#评论插件\" class=\"headerlink\" title=\"评论插件\"></a>评论插件</h3><p>&nbsp;&nbsp;&nbsp; 有很多免费的第三方评论插件提供商，你可以通过简单的配置使用他们的数据库管理你网站的评论数据，hexo默认集成的是Disqus，但是有GFW存在，所以我选择了国内的<a href=\"http://duoshuo.com/\">多说</a>。直接用你的微博&#x2F;豆瓣&#x2F;人人&#x2F;百度&#x2F;开心网帐号登录多说，做一下基本设置。你也可以在多说后台自定义一下多说评论框的格式，比如评论框的位置，对于css设置，可以<a href=\"http://dev.duoshuo.com/docs/4ff1cfd0397309552c000017\">参考这里</a>。如果你是有的其他第三方评论系统，将通用代码粘贴到&#x2F;themes&#x2F;themename&#x2F;layout&#x2F;_partial&#x2F;comment.ejs里面：</p>\n<pre><code class=\"hljs\">&lt;% if (config.disqus_shortname &amp;&amp; page.comments)&#123; %&gt;\n&lt;section id=&quot;comment&quot;&gt;\n  #你的通用代码\n&lt;% &#125; %&gt;\n</code></pre>\n<h3 id=\"域名配置\"><a href=\"#域名配置\" class=\"headerlink\" title=\"域名配置\"></a>域名配置</h3><p>&nbsp;&nbsp;&nbsp; 国内域名服务商有万网、腾讯、阿里、美橙等等，国外推荐<a href=\"http://www.godaddy.com/\">狗爹（godaddy）</a>。<br>&nbsp;&nbsp;&nbsp; 买完域名你需要给域名指定DNS服务器。DNS服务商非常多，一般域名服务商和云主机服务商都提供DNS服务，我选择的是国内的<a href=\"http://www.dnspod.cn/\">DNSPod</a>，免费的，提供监测网站状态功能，还挺好用。<br>&nbsp;&nbsp;&nbsp; 域名服务商和DNS服务商那边的配置它们各自网站都会提供教程，自己网站空间中给静态网站绑定域名很简单，在网站根目录放一个叫CNAME的文档，里面填上你的域名就行了。</p>\n<h3 id=\"参考文章\"><a href=\"#参考文章\" class=\"headerlink\" title=\"参考文章\"></a>参考文章</h3><p><a href=\"http://ibruce.info/2013/11/22/hexo-your-blog/\">http://ibruce.info/2013/11/22/hexo-your-blog/</a>（大大的教程写的真心详细，基本就是这篇领我进门）</p>\n",
            "tags": [
                "github",
                "domain",
                "DNS",
                "hexo"
            ]
        }
    ]
}